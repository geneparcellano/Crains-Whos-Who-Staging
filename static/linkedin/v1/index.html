<!DOCTYPE html>
<html>
<head>
<title>Connections App Example</title>

<meta charset="utf-8">
<style>
	.match {
		background-color: #FF0;
	}
</style>
<script src="assets/js/jquery-1.8.2.min.js" ></script>

</head>
<body>
	<ol></ol>

	<script type="text/javascript" src="http://platform.linkedin.com/in.js">
		api_key: uikex2riroaw
		scope: r_network
		authorize: true
	</script>

	<script type="text/javascript">
		var myCompany,
			myConnections;

		function loadData() {

			IN.API.Profile("me")
				.fields(["firstName","headline","positions:(company)"])
				.result(function(result) {
					console.log(result);
					// myProfile = result;
					myCompany = result.values[0].positions['values'][0].company['name'];
					applyData();
				});

			// IN.API.PeopleSearch()
			// 	.fields("firstName", "lastName", "distance", "publicProfileUrl","pictureUrl")
			// 	.params({"keywords": "princess", "count": 10, "sort": "distance"})
			// 	.result(function(result) {
			// 		console.log(result);
			// 		console.log(result.people.values);
			// 		$.each(result.people.values, function(i, connection) {
			// 			console.log(connection.firstName +' '+connection.lastName);
			// 		});
			// 	}
			// );

			IN.API.Connections("me")
				.fields(["id", 'headline', "first-name", "last-name", "picture-url", "positions"])
				.params({'count':500, 'sort': 'distance'})
				.result(function(result){
					myConnections = result;
					// console.log('my company: '+myCompany);

					$.each(myConnections.values, function(a, b) {
						if (b.firstName !== 'private' && b.positions['values']) {

							$('ol').append('<li id="'+b.id+'">'+b.firstName+' '+b.lastName+'</li>');

							var companyName = b.positions['values'][0].company['name'];
							
							if (companyName.toLowerCase().indexOf(myCompany) !== -1) {
								$('#'+b.id).addClass('match');
							}
						}
					});
				});
		}


		function applyData() {
			console.log(myCompany);
	
		}
	</script>

    <script type="IN/Login" data-onAuth="loadData"></script>

</body>
</html>